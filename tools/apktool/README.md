# Containerized apktool

## Basic info

- **Current version**: 2.9.x
- **Source**: https://github.com/iBotPeaches/Apktool

## Use indepentendly to [containers4pentesters](https://github.com/TheArqsz/containers4pentesters) project

This image contains `user.home` and `java.io.tmpdir` java variables set in Dockerfile and they are pointing to `/tmp`. This is related to how apktool works and that it needs aome directories for temporary storage. Due to the fact, that /tmp is writeable (in most cases) by anyone, it was the obvious choice. Other directories are mounted as usually:
- `PWD`
- `HOME`
- `/tmp`
- `/dev`

### CLI

Use in CLI directly as a pull from the DockerHub:

```bash
docker pull containers4pentesters/apktool
docker run -it --rm --name apktool \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        --workdir "$(pwd)" \
        -e HOME="$HOME" \
        -e TERM=$TERM containers4pentesters/apktool \
            --help
```

or as a build (with [containers4pentesters](https://github.com/TheArqsz/containers4pentesters) repository cloned):

```bash
docker build -q -t containers4pentesters/apktool:latest /opt/containers4pentesters/tools/apktool/
docker run -it --rm --name apktool \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        --workdir "$(pwd)" \
        -e HOME="$HOME" \
        -e TERM=$TERM containers4pentesters/apktool:latest \
            --help
```

### As a script

You can create a script `/usr/local/bin/apktool` with given content (pulling from the DockerHub):

```bash
#!/usr/bin/env bash

docker pull -q containers4pentesters/apktool:latest
docker run -it --rm --name apktool \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        --workdir "$(pwd)" \
        -e HOME="$HOME" \
        -e TERM=$TERM containers4pentesters/apktool \
            "$@"
```

or as a build process (with [containers4pentesters](https://github.com/TheArqsz/containers4pentesters) repository cloned):

```bash
#!/usr/bin/env bash

docker build -q -t containers4pentesters/apktool:latest /opt/containers4pentesters/tools/apktool/
docker run -it --rm --name apktool \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        --workdir "$(pwd)" \
        -e HOME="$HOME" \
        -e TERM=$TERM containers4pentesters/apktool \
            "$@"
```

You can use the script as if it was a native tool:

```console
$ /usr/local/bin/apktool d app.apk --no-src --force -m --output ./build
I: Using Apktool v2.9.3-SNAPSHOT on app.apk
I: Loading resource table...
I: Decoding file-resources...
I: Loading resource table from file: /tmp/.local/share/apktool/framework/1.apk
I: Decoding values */* XMLs...
I: Decoding AndroidManifest.xml with resources...
I: Copying raw classes.dex file...
I: Copying raw classes2.dex file...
I: Copying assets and libs...
I: Copying unknown files...
I: Copying original files...
I: Copying META-INF/services directory
```