ARG GO_VERSION=1.18.3

FROM golang:${GO_VERSION}-alpine AS build

RUN apk add --no-cache git
WORKDIR /src

RUN git clone https://github.com/OJ/gobuster.git

WORKDIR /src/gobuster

RUN CGO_ENABLED=0 go build -o /gobuster .

FROM gcr.io/distroless/base

COPY --from=build /gobuster /usr/bin/gobuster

ENTRYPOINT ["/usr/bin/gobuster"]