#!/usr/bin/env bash

SCRIPTPATH="$( cd -- "$(dirname "$0")" >/dev/null 2>&1 ; pwd -P )"
TOOLS_PATH="$(dirname $SCRIPTPATH)"
SCRIPTS_PATH="$(dirname $TOOLS_PATH)/scripts"
CURRENT_TOOL=$(basename $SCRIPTPATH)
VERIFY_INSTALLED=${1:-}

test_tool() {
    command=$(bash $SCRIPTS_PATH/run.sh $CURRENT_TOOL help)
    pattern="Target host/URL (alias of -host)"
    if ! grep "$pattern" <<< "$command" &>/dev/null; then
        if [ -z VERIFY_INSTALLED ]; then
            echo "Tool $CURRENT_TOOL is not installed."
        fi
        echo "Tool $CURRENT_TOOL doesn't work properly - verify installation."
        exit 1
    else
        exit 0
    fi
}

test_tool