# Containerized trufflehog

## Basic info

- **Current version**: 3.69.0
- **Source**: https://github.com/trufflesecurity/trufflehog/archive/refs/tags/v3.69.0.zip

## Use indepentendly of the [containers4pentesters](https://github.com/TheArqsz/containers4pentesters) project

### CLI

Use in CLI directly as a pull from the DockerHub:

```bash
docker pull containers4pentesters/trufflehog
docker run -it --rm --name trufflehog \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        -e HOME="$HOME" \
        -e TERM=$TERM \
        --network host containers4pentesters/trufflehog \
            --help
```

or as a build (with [containers4pentesters](https://github.com/TheArqsz/containers4pentesters) repository cloned):

```bash
docker build -q -t containers4pentesters/trufflehog:latest /opt/containers4pentesters/tools/trufflehog/
docker run -it --rm --name trufflehog \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        -e HOME="$HOME" \
        -e TERM=$TERM \
        --network host containers4pentesters/trufflehog:latest \
            --help
```

### As a script

You can create a script `/usr/local/bin/trufflehog` with given content (pulling from the DockerHub):

```bash
#!/usr/bin/env bash

docker pull -q containers4pentesters/trufflehog:latest
docker run -it --rm --name trufflehog \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        -e HOME="$HOME" \
        -e TERM=$TERM \
        --network host containers4pentesters/trufflehog \
            "$@"
```

or as a build process (with [containers4pentesters](https://github.com/TheArqsz/containers4pentesters) repository cloned):

```bash
#!/usr/bin/env bash

docker build -q -t containers4pentesters/trufflehog:latest /opt/containers4pentesters/tools/trufflehog/
docker run -it --rm --name trufflehog \
        --user `id -u`:`id -g` \
        --volume "$HOME":"$HOME" \
        --volume "$(pwd)":"$(pwd)" \
        --volume /tmp:/tmp \
        -e HOME="$HOME" \
        -e TERM=$TERM \
        --network host containers4pentesters/trufflehog \
            "$@"
```

You can use the script as if it was a native tool:

```bash
$ mkdir /tmp/test-truffle
$ ssh-keygen -q -t rsa -b 2048 -f /tmp/test-truffle/id_rsa -P ''
$ trufflehog --github-actions filesystem --no-verification /tmp/test-truffle
ğŸ·ğŸ”‘ğŸ·  TruffleHog. Unearth your secrets. ğŸ·ğŸ”‘ğŸ·

YYYY-MM-DDTHH:mm:SSZ    info-0  trufflehog      running source  {"source_manager_worker_id": "hD3Yb", "with_units": true}
::warning file=/tmp/test-truffle/id_rsa,line=0,endLine=0::Found unverified PrivateKey result ğŸ·ğŸ”‘
YYYY-MM-DDTHH:mm:SSZ    info-0  trufflehog      finished scanning       {"chunks": 2, "bytes": 2233, "verified_secrets": 0, "unverified_secrets": 1, "scan_duration": "13.714886ms"}
```
